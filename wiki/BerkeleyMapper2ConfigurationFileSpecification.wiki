#summary XML Specification for BerkeleyMapper 2 Configuration Files


<wiki:toc max_depth="1" />

= Introduction =

This file is specified in the calling URL by setting configfile=<some location>.  You may put this file on any URL.  Please validate your XML before putting a configfile into place and testing it.  If you have any questions you may contact the administrator for assistance.

= A Note on Special Characters =
<p>Since data is passed using XML documents, embedded in databases, and sometimes coming from text documents, care should be taken in using special characters.  It is reccomended to use the named entity references (see, for example <a href="http://home.earthlink.net/~bobbau/platforms/specialchars/">http://home.earthlink.net/~bobbau/platforms/specialchars/</a>).  In addition, any & symbol should be entered as a named reference, even when used in identify named references.  

= Opening Tag =
{{{<berkeleymapper>}}}

= Metadata Section =
{{{<metadata}}}

<p>

||<b>Element:</b>||<pre><mapwiki></pre>||
||<b>Attributes:</b>||organization,email||
||<b>Repeatable:</b>||No||
||<b>Example:</b>||<pre><mapwiki organization="Museum of Vertebrate Zoology" email="fredflintstone@aol.com" /></pre>||
||<b>Description:</b>||Instruct mapwiki calls to fill in default organization and email.||

<p>

||<b>Element:</b>||<pre><abstract></pre>||
||<b>Attributes:</b>||None||
||<b>Repeatable:</b>||No||
||<b>Example:</b>||<pre><abstract>GIS configuration file for MVZ query interface</abstract></pre>||
||<b>Description:</b>||A more in-depth description of what the purpose of this application does for the group.||

<p>

||<b>Element:</b>||<pre><mapkeyword></pre>||
||<b>Attributes:</b>||keyword||
||<b>Repeatable:</b>||No||
||<b>Example:</b>||<pre><mapkeyword keyword="specimens"></mapkeyword></pre>||
||<b>Description:</b>||This specifies what we are mapping.  By default is specimens but if you put another word here, it will refer to the points as this word.||

<p>

||<b>Element:</b>||<pre><disclaimer></pre>||
||<b>Attributes:</b>||||
||<b>Repeatable:</b>||No||
||<b>Example:</b>||<pre><disclaimer><![CDATA[Data records provided by ORNIS may be used by individual researchers or research groups, but they may not be repackaged, resold, or redistributed in any form without the express written consent of the original institution where those records are held.<p>Citations: ....(etc)]]></disclaimer></pre>||
||<b>Description:</b>||This is a user-supplied disclaimer to display when users are downloading data.  Make sure you use the CDATA syntax if you include HTML tags here.||

<p>
{{{</metadata>}}}

= Record LinkBack =
{{{<recordlinkback>}}}
<p>
Record Linkbacks in BerkeleyMapper 2.0 are expected to be fully formatted from the calling application.
<p>
{{{<a href="someurl">12345</a>}}}
<p>
{{{</recordlinkback>}}}

= Matching tab-delimited fields to Map schema =
{{{<concepts xmlns:darwin="http://digir.net/schema/conceptual/darwin/2003/1.0">}}}
<p>

||<b>Element:</b>||<concept>||
||<b>Attributes:</b>||<i>viewlist</i>: 0 means do not show this field in query results.  1 means to show it.<br><i>colorlist</i>: 0 means do not add this as an option under 'Color By'.  1 means add this as an option to 'Color By', so the user can display unique colors for each unique value in this field.<br><i>datatype</i>: name of concept in <a href="/schemas/darwin2resultmapping.xsd">mapfile schema</a> or specification of new datatype.<br><i>alias</i>: Your name for this field which will also appear on column headings of query results.<br><i>order</i>: any number to designate what order this should be displayed in results table.||
||<b>Repeatable:</b>||No||
||<b>Example:</b>||See following file:||
||<b>Description:</b>|| This section defines names of server-side-fields, aliases, and whether we want to view it.  If there are concepts outside the map schema, then they go into sequentially numbered, typed fields (char120:1-8,char255:1-8,longtext:1-4,int:1-4,float:1-4).  The order of the fields MUST match the order of the fields in the tab delimited file being passed to this application.||

<p>
{{{
<concepts>
<concept viewlist="1" colorlist="0" datatype="darwin:catalognumbertext" alias="CatalogNumber" order="1" />
<concept viewlist="1" colorlist="1" datatype="darwin:scientificname" alias="ScientificName" order="2" />
<concept viewlist="0" colorlist="1" datatype="darwin:country" alias="Country" order="9" />
<concept viewlist="0" colorlist="0" datatype="darwin:stateprovince" alias="StateProvince" order="3" />
<concept viewlist="1" colorlist="1" datatype="darwin:county" alias="County" order="4" />
<concept viewlist="0" colorlist="0" datatype="char120:1" alias="id_modifier" order="11" />
<concept viewlist="0" colorlist="0" datatype="char120:2" alias="Coll_Object_id" order="12" />
<concept viewlist="0" colorlist="0" datatype="char120:3" alias="type_status" order="5" />
<concept viewlist="0" colorlist="1" datatype="char120:4" alias="class" order="5" />
<concept viewlist="0" colorlist="1" datatype="char120:5" alias="order" order="50" />
<concept viewlist="0" colorlist="1" datatype="char120:6" alias="family" order="10" />
<concept viewlist="0" colorlist="0" datatype="char120:7" alias="tissues" order="19" />
<concept viewlist="0" colorlist="0" datatype="char120:8" alias="sex_cde" order="20" />
<concept viewlist="1" colorlist="0" datatype="darwin:collectioncode" alias="CollectionCode" order="1" />
<concept viewlist="0" colorlist="0" datatype="darwin:decimallatitude"	alias="DecimalLatitude" order="20" />
<concept viewlist="0" colorlist="0" datatype="darwin:decimallongitude" alias="DecimalLongitude" order="21" />
<concept viewlist="0" colorlist="0" datatype="darwin:coordinateuncertaintyinmeters" alias="CoordinateUncertaintyInMeters" order="22" />
<concept viewlist="1" colorlist="0" datatype="darwin:horizontaldatum"	alias="HorizontalDatum" order="23" />
</concepts>
}}}

= GIS Data Section (KML) =
{{{<gisdata>}}}
<p>

||<b>Element:</b>||<pre><layer></pre>||
||<b>Attributes:</b>||<i>title</i>: Title of this layer as it appears in legend and to the user<br><i>name</i>: Internal name for this layer (corresponds to Mapserver Name used in Layer definition)<br><i>location</i>: Location of Mapserver Layer Definition.  Can exist anywhere that is web-accessible<br><i>legend</i>: Value of 1 means to include in legend and 0 means to leave it out.<br><i>active</i>: Value of 1 means to make this layer active by default. Value of 0 will display this layer to the user but box will not be checked by default.<br><i>url</i>: URL that points to more information about the source of this layer.||
||<b>Repeatable:</b>||yes||
||<b>Examples:</b>||||

<br>A particular shapefile (that is loaded on server):<pre><layer title="Plant Bed Layers" name="plant_bed_areas" location="/data/ucbg/plant_bed_areas.lyr" legend="1" active="1" url="http://someurl.com/" /></pre>||
<br>Global Amphibian Assessment (must dynamically construct config file for each species):<pre><layer title="GAA Bufo canorus Distribution" name="gaa" location="Bufo canorus" legend="1" active="1" url="http://www.iucnredlist.org/amphibians"/></pre>
<br>NatureServe North American Bird Ranges (must dynamically construct config file for each species):<pre><layer title="NatureServe North American Bird Distribution" name="birds" location="Lagopus lagopus" legend="1" active="1" url="http://www.natureserve.org/getData/birdMaps.jsp"/></pre>
<br>NatureServe North American Mammal Ranges (must dynamically construct config file for each species):<pre><layer title="NatureServe North American Mammal Distribution" name="mamm" location="Lynx rufus" legend="1" active="1" url="http://www.natureserve.org/getData/mammalMaps.jsp"/></pre>


<b>Description:</b> This option allows users to pass in multiple layers that are custom to their application.  Layer definitions must be in the form of <a href='http://mapserver.gis.umn.edu/'>Mapserv</a> Mapfile format. Layers can be shapefiles, loaded in Postgres, or accessible via WMS.  See <a href='mailto:bnhm@berkeley.edu'>admin</a> for assistance.

<p>
{{{</gisdata>}}}

= Closing Tag =
{{{</berkeleymapper>}}}